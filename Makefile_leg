# f90 and .x and .mod +in different locations

SRCDIR = src
BUILDDIR = build
BINDIR = bin

FC = gfortran
LD = gfortran
F90FLAGS = -fbounds-check -Wall -fbacktrace -g
OBJECTS = type_defs.o leg_funs.o test_leg.o
OBJ_AND_DIR = $(OBJECTS:%.o=$(BUILDDIR)/%.o)
EXECUTABLE = test_leg.x

.PHONY: clean
$(EXECUTABLE): $(OBJECTS)
	@echo "$(LD) -o $(BINDIR)/$(EXECUTABLE) $(OBJ_AND_DIR)"; $(LD) -o $(BINDIR)/$(EXECUTABLE) $(OBJ_AND_DIR)
%.o : $(SRCDIR)/%.f90
	@echo "$(FC) -J$(BUILDDIR) $(F90FLAGS) -c $< -o $(BUILDDIR)/$@"; $(FC) -J$(BUILDDIR) $(F90FLAGS) -c $< -o $(BUILDDIR)/$@
clean:
	rm -f $(OBJECTS) $(EXECUTABLE)
